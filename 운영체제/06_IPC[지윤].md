## **IPC(Inter Process Communication)**

-   독립적인 메모리 공간을 갖는 프로세스 간의 통신 기법
-   한 프로세스가 다른 프로세스의 자원을 사용하기 위해 동시에 접근 가능한 메모리 즉, 프로세스들이 공유하는 메모리가 필요
-   커널 영역에서 IPC라는 내부 프로세스 간 통신 설비를 제공

</br>

### **1\. 공유 메모리 (Shared Memory)**

![image](https://user-images.githubusercontent.com/64777557/221493940-b1653741-8594-4b70-b3a9-5ee71b77097b.png)

-   공유 메모리(Shared Memory)가 데이터 자체를 공유하도록 설비
-   프로세스가 공유 메모리 할당을 커널에 요청하면 커널은 해당 프로세스에 메모리 공간을 할당
-   모든 프로세스는 공유 메모리에 접근할 수 있음
-   Text와 Data 영역 사이 공유 메모리 포인팅 공간 (각 프로세스가 메모리 영역에 첨부되는 방식)
-   프로세스 간 Read, Write를 모두 필요로 할 때 사용
-   중개자 없이 곧바로 메모리에 접근할 수 있기 때문에 모든 IPC 중 가장 빠르게 작동
-   동기화에 주의

</br>

### **2\. 파이프 (Pipe)**

-   통신을 위한 메모리 공간(버퍼)을 생성하여 프로세스가 데이터를 주고 받게끔 함
-   단방향 통신 지원

#### **2-1) 익명 파이프 (Anonymous PIPE)**

![image](https://user-images.githubusercontent.com/64777557/221493985-7c18a42b-ca0c-447b-9b8c-6c0283949f9e.png)

-   익명의 PIPE를 통해 동일한 부모-자식 or 형제 프로세스 간의 단방향 통신을 지원
    -   통신할 프로세스를 명확히 알 수 있어야 함
    -   외부 프로세스에서 사용할 수 없음
-   파이프로 두 개의 프로세스를 연결하고 하나의 프로세스는 데이터를 쓰기만, 다른 하나는 데이터를 읽기만 함
-   한쪽 방향으로만 통신이 가능한 파이프의 특성 때문에 **반이중(Half-Duplex) 통신**이라고도 부름
-   간단하게 사용할 수 있지만 전이중 통신으로 송/수신을 모두 하려면 두 개의 파이프를 만들어야 해서 구현이 복잡해짐
-   pipe 함수로 생성

#### **2-2) 네임드 파이프 (Named PIPE)**

![image](https://user-images.githubusercontent.com/64777557/221494033-1f8436d1-b26f-4aa2-af41-d123673eb1bc.png)

-   이름이 있는  파일을 사용하기 때문에 부모 프로세스와 무관한 다른 프로세스끼리도 통신 가능
    -   다른 프로세스들이 PIPE 이름만 알면 통신 가능
    -   외부 프로세스도 사용 가능
-   익명 파이프와 마찬가지로 반이중 통신 방식이기 때문에 전이중 통신을 위해서는 두 개의 파이프를 만들어야해 구현이 복잡해짐
-   mkfifo나 mknod 함수로 생성

</br>

### **3\. 소켓 (Socket)**

![image](https://user-images.githubusercontent.com/64777557/221494066-26d5a0e4-dafc-4b77-ad47-9e4fef2530c9.png)

-   동일한 호스트 운영 체제에서 실행되는 프로세스 간 데이터를 교환하기 위한 데이터 통신 엔드포인트
-   네트워크 소켓 통신을 통해 데이터 공유
    -   데이터 교환을 위해 양쪽 PC에서 각각 임의의 포트를 정하고 해당 포트 간의 연결을 통해 데이터를 주고 받는 방식
    -   각 PC가 타 PC 포트에 연결되면 PIPE처럼 1대1로 데이터를 주고받음
-   같은 도메인 내 원격에서 프로세스 간 데이터를 공유할 때 사용
-   클라이언트/서버의 통신 구조
    -   서버는 bind, listen, accept 과정을 통해 소켓 연결 준비
    -   클라이언트는 connect를 서버에 요청
    -   연결 수립 후 socket에 데이터 send()
    -   연결 해제 시 socekt close()
-   **전이중(Full Duplex)/양방향 통신**이 가능

</br>

### **4\. 메시지 큐 (Message Queue)**

![image](https://user-images.githubusercontent.com/64777557/221494121-b8c048a6-2532-478a-af9e-2323d9215ae2.png)

-   입출력 방식은 Named PIPE과 동일하지만 데이터 흐름이 아닌 메모리 공간을 사용한 PIPE임
-   다수의 프로세스 간 메시지를 전달할 수 있음
-   사용할 데이터에 번호를 붙혀 여러 프로세스가 동시에 데이터를 쉽게 다룰 수 있음
-   메시지 접근을 위해 key 필요

</br>

### **5\. 메모리 맵 (Memory Map)**

![image](https://user-images.githubusercontent.com/64777557/221494148-33015ddf-ef53-49fe-8042-95107be95316.png)

-   공유 메모리처럼 메모리 공간을 공유하지만 열린 파일을 메모리에 매핑시켜 공유하는 방식
-   프로세스의 가상 메모리 주소 공간에 파일을 매핑한 뒤 가상 메모리 주소로 직접 접근하는 것으로 파일 읽기/쓰기를 대신
-   주로 파일로 대용량 데이터를 공유해야할 때 사용
-   페이징 기법을 사용해 파일의 내용을 관리하며 페이지 크기에 따라 적절히 파일의 내용을 읽고 쓸 수 있음
-   대부분 운영체제에서는 프로세스를 실행할 때 실행 파일의 각 세그먼트를 메모리에 사상하기 위해 메모리 맵 파일을 이용

</br>

### **6\. RPC (Remote Procedure Call)**

-   별도의 원격 제어를 위한 코딩 없이 다른 주소 공간에서 함수나 프로시저를 실행할 수 있게하는 프로세스 간 통신 기술
-   원격 프로시저 호출을 통해 프로그래머는 함수가 실행 프로그램에서 로컬 위치에 있던 원격 위치에 있든 동일한 코드를 이용할 수 있음
-   분산 네트워크 망에서 많이 사용하는 방식
-   분리된 PC에 저장된 데이터를 마치 내 PC에 존재하는 것처럼 데이터를 가져와 사용하는 통신 방법
    -   스텁(Stub)을 통해 마치 데이터가 자신의 디스크에 존재하는 것처럼 착각을 일으킴

</br></br>

### **IPC 정리**

| **IPC 종류** | **PIPE** | **Named PIPE** | **Message Queue** | **Shared Memory** | **Memory Map** | **Socket** |
| --- | --- | --- | --- | --- | --- | --- |
| **용도** | 부모 자식 간   단방향 통신 | 다른 프로세스와   단방향 통신 | 다른 프로세스와   단방향 통신 | 다른 프로세스와   양방향 통신 | 다른 프로세스와   양방향 통신 | 다른 시스템 간   양방향 통신 |
| **공유 매개체** | 파일 | 파일 | 메모리 | 메모리 | 파일+메모리 | 소켓 |
| **통신단위** | stream | stream | 구조체 | 구조체 | 페이지 | stream |
| **통신방향** | 단방향 | 단방향 | 단방향 | 양방향 | 양방향 | 양방향 |
| **통신 가능 범위** | 동일 시스템 | 동일 시스템 | 동일 시스템 | 동일 시스템 | 동일 시스템 | 동일+외부 시스템 |

</br></br>

### **⭐️ 참고**

-   [https://dar0m.tistory.com/233](https://dar0m.tistory.com/233)
-   [https://heeonii.tistory.com/13](https://heeonii.tistory.com/13)
