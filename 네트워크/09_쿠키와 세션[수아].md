## 쿠키와 세션의 필요성
- HTTP의 약점을 보완하기 위해 사용 
  1. 비연결형(connectionless)
  2. 무상태(stateless)
- 통신이 1번 되면 서버와 클라이언트의 연결이 끊어지기 때문에 서버는 **클라이언트가 누구인지** 매번 인증해야 함 
- 이 번거로움을 해결하기 위해 `쿠키`와 `세션`을 사용 

</br>

## 쿠키(Cookie)
- `사용자에 의해 조작되어도 크게 문제되지 않을 정보를 브라우저(client)에 저장`
- 서버에서 사용자의 컴퓨터(client)에 저장하는 작은 기록 정보 파일 
- 필요할 때 정보 참조 or 재사용 가능 

![image](https://user-images.githubusercontent.com/63537847/218002800-0ec8f8cc-a433-4670-bdb8-687214609d42.png)


💡 **특징**  
1. 클라이언트에 총 300개의 쿠키 저장 가능
2. 1개의 도메인은 20개의 쿠키 가질 수 있음
3. 하나의 쿠키는 4KB까지 저장 가능 
4. 유효시간 동안은 브라우저가 종료되어도 인증이 유지됨 
5. Response Header에 Set-Cookie 속성을 사용하면 클라이언트에 쿠키를 만들 수 있음
6. 쿠키는 사용자가 따로 요청하지 않아도 브라우저가 Request시에 Request Header를 넣어서 자동으로 서버에 전송

📦 **구성 요소** 
1. 이름 : 각각의 쿠키 구별하는데 사용
2. 값 : 쿠키의 이름과 관련된 값
3. 유효시간(만료일) : 유지 기간
4. 도메인 : 쿠키 전송하는 도메인(서버)
5. 경로 : 전송 요청 경로 

🛠️ **동작 방식** 
1. 클라이언트가 페이지 요청
2. 서버는 쿠키 생성 
3. HTTP 헤더에 쿠키를 담아서 전송 (server → client) 
4. 클라이언트가 갖고 있다가(로컬 PC에 저장) 서버에 다시 요청할 때 요청과 쿠키를 함께 전송
5. 동일 사이트 재방문 시 클라이언트의 PC에 해당 쿠키가 있는 경우, 요청 페이지와 함께 쿠키를 전송
6. 서버에서 쿠키를 읽어 이전 상태 정보를 변경 할 필요가 있을 때 쿠키를 업데이트 하여 변경된 쿠키를 HTTP 헤더에 포함시켜 응답

✏️ **사용 예시**
- 방문 사이트에서 로그인 할 때 "아이디와 비밀번호를 저장하시겠습니까?"
- 팝업창 "오늘 이 창 다시 보지 않기"
- 쇼핑몰 장바구니 

</br>

## 세션(Session)
- 중요한 정보 관리 → 사용자가 직접 데이터를 수정할 수 없음 
- `인증에 대한 정보를 서버가 저장`
- 서버에서 클라이언트 구별하기 위해 session id 부여 후 브라우저가 서버에 접속해서 종료할 때까지 인증 상태 유지 
  - session id : 클라이언트가 Request를 보내면, 해당 서버의 엔진이 클라이언트에게 부여하는 유일한 ID
- 접속 시간에 제한을 두어 일정 시간 응답이 없다면 정보가 유지되지 않게 설정이 가능
- 쿠키보다 보안성 좋음
- 사용자가 많아질수록 서버 메모리를 많이 차지 (서버에 과부하 주어서 성능 저하의 요인이 됨) 

💡 **특징**  
1. 웹 서버에 웹 컨테이너의 상태를 유지하기 위한 정보 저장 
2. 각 클라이언트에게 고유 ID를 부여
3. 세션 ID로 클라이언트를 구분해서 클라이언트의 요구에 맞는 서비스를 제공
4. 보안 면에서 쿠키보다 우수 
5. 사용자가 많아질수록 서버 메모리를 많이 차지하게 됨
6. 저장 데이터의 제한 없음

🛠️ **동작 방식** 
1. 클라이언트가 페이지에 요청 
2. 서버는 접근한 클라이언트의 Request-Header 필드인 Cookie를 확인하여, 클라이언트가 해당 session-id를 보냈는지 확인
3. session-id가 존재하지 않는다면 서버는 session-id를 생성해 클라이언트에게 돌려줌
4. 서버에서 클라이언트로 돌려준 session-id를 쿠키를 사용해 서버에 저장
5. 클라이언트는 재접속 시, 이 쿠키를 이용해 session-id 값을 서버에 전달

✏️ **사용 예시**
- 화면을 이동해도 로그인이 풀리지 않고 로그아웃하기 전까지 유지

</br>

## 쿠키 vs 세션 
||쿠키(Cookie) |세션(Session) |
|---|---|---|
|정보 저장 위치|클라이언트(브라우저)|서버(서버의 자원 사용)|
|보안|변질되거나 request에서 스니핑 당할 우려가 있어서 보안에 취약|쿠키를 이용해서 session-id만 저장하고 그것으로 구분하여 서버에서 처리하기 때문에 비교적 보안성이 높음|
|라이프사이클|파일로 저장되어 브라우저 종료해도 정보 유지됨 </br> 만료기간 따로 지정해서 쿠키 삭제할 때까지 유지 가능|브라우저 종료되면 만료기간에 상관없이 삭제|
|속도|빠름(쿠키에 정보 있어서)|느림(정보가 서버에 있어서)|

### 세션보다 쿠키를 사용하는 이유는?
- 세션의 서버의 자원을 사용하기 때문에 자원에 한계가 있음
- 서버의 속도가 느려질 수 있기 때문에 쿠키와 세션을 적절한 요소 및 기능에 병행 사용
- 서버 자원의 낭비를 방지하며 웹사이트의 속도 ⬆️

</br>

# 토큰(Token)
- `인증에 대한 정보를 사용자가 저장`
- **등장 이유** : 
  - 시스템의 규모가 커짐에 따라 


</br>
</br>

> 참고                    
> https://dev-coco.tistory.com/61        
> https://interconnection.tistory.com/74          
> https://mangkyu.tistory.com/55         
